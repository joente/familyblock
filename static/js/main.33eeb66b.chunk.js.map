{"version":3,"sources":["serviceWorker.js","AnimateMoveUp.js","AnimateMerge.js","Cell.js","Highlight.js","Grid.js","Tile.js","Tiles.js","Score.js","index.js","Game.js"],"names":["Boolean","window","location","hostname","match","AnimateMoveUp","state","tile","toCell","unit","move","target","speed","normalize","getYpos","size","width","height","animate","container","position","y","setTile","AnimateMerge","withCell","direction","getXpos","console","log","done","x","remove","nextTile","Cell","stage","pos","col","row","cellTexture","bg","PIXI","cellpos","animation","addChild","resize","visible","isEmpty","hide","newTile","getValue","value","getIndex","index","getTile","moveTileUp","mergeTile","parent","Highlight","offset","ok","nok","sprite","update","newCol","newSprite","Grid","score","tiles","w","h","cells","from","okTexture","nokTexture","highlight","isAnimating","targetIndex","push","lastRow","rows","forEach","cell","colOnGrid","mpos","Math","floor","colOkNok","undefined","select","cellsToAnimate","colsMoved","processGrid","length","reduce","total","toList","Array","fill","r","i","n","includes","slice","reverse","ce","cols","ma","cidx","nextTarget","mi","final","cb","addTile","Tile","allTiles","str","color","graphics","style","fontFamily","fontSize","fontWeight","align","stroke","strokeThickness","lineJoin","text","isSmall","clear","lineStyle","beginFill","drawRoundedRect","endFill","dupTile","removeChild","Tiles","numTiles","rasterTexture","currentRaster","nextRaster","minTileIndex","randColor","random","current","next","normalizeTiles","renderTiles","diff","idx","getRandomTile","getCurrentTile","stealCurrentTile","Score","fontStyle","toLocaleString","game","app","innerWidth","innerHeight","appendChild","view","renderer","display","backgroundColor","autoResize","interactive","placeTile","grid","on","event","data","getLocalPosition","ww","wh","requestAnimationFrame","render","Game","document","body","navigator","serviceWorker","ready","then","registration","unregister","catch","error","message","addEventListener"],"mappings":"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","file":"static/js/main.33eeb66b.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","const AnimateMoveUp = (state) => {\n    const {tile, toCell, unit} = state;\n\n    let move = {\n        target: 0,\n        speed: -1,\n    }\n\n    const normalize = () => {\n        move.target = toCell.getYpos();\n        move.speed = -5.0*unit.size;\n        tile.width = 10*unit.size;\n        tile.height = 10*unit.size;\n    }\n\n    normalize();\n\n    const animate = () => {\n        tile.container.position.y += move.speed;\n        if (tile.container.position.y <= move.target) {\n            toCell.setTile(tile);\n            return true;  // finished\n        }\n        return false;  // not finished\n    }\n    return {\n        animate,\n        normalize,\n    };\n}\n\nexport default AnimateMoveUp;","const AnimateMerge = (state) => {\n    const {tile, withCell, direction, unit} = state;\n\n    let move = {\n        target: 0,\n        speed: 0,\n    }\n\n    const normalize = () => {\n        switch (direction) {\n        case \"up\":\n            move.target = withCell.getYpos();\n            break;\n        case \"right\":\n        case \"left\":\n            move.target = withCell.getXpos();\n            break;\n        default:\n            console.log(\"unknown direction: \", direction);\n        }\n\n        move.speed = 1*unit.size;\n        tile.width = 10*unit.size;\n        tile.height = 10*unit.size;\n    }\n\n    normalize();\n\n    const animate = () => {\n        let done = false;\n\n        switch (direction) {\n        case \"up\":\n            tile.container.position.y += move.speed;\n            done = tile.container.position.y >= move.target;\n            break;\n        case \"right\":\n            tile.container.position.x += move.speed;\n            done = tile.container.position.x >= move.target;\n            break;\n        case \"left\":\n            tile.container.position.x -= move.speed;\n            done = tile.container.position.x <= move.target;\n            break;\n        default:\n            console.log(\"unknown direction: \", direction);\n        }\n        if (done) {\n            tile.remove();\n            withCell.nextTile();\n            return true;  // finished\n        }\n        return false;  // not finished\n    }\n    return {\n        animate,\n        normalize,\n    };\n}\n\nexport default AnimateMerge;","import * as PIXI from \"pixi.js\";\nimport AnimateMoveUp from \"./AnimateMoveUp\";\nimport AnimateMerge from \"./AnimateMerge\";\n\n\nconst Cell = (state) => {\n    const {stage, pos, unit, col, row, cellTexture} = state;\n    const bg = new PIXI.Sprite(cellTexture);\n    const cellpos = {x: 0, y: 0, size: 0};\n\n    let tile = null;\n    let animation = null;\n\n    const normalize = () => {\n        cellpos.x = pos.x + unit.size*10*col;\n        cellpos.y = pos.y + unit.size*10*row;\n        cellpos.size = 10*unit.size;\n\n        if (bg.visible) {\n            bg.position.x = cellpos.x;\n            bg.position.y = cellpos.y;\n            bg.width = bg.height = cellpos.size;\n        }\n\n        if (tile !== null) {\n            tile.container.position.x = cellpos.x;\n            tile.container.position.y = cellpos.y;\n            tile.normalize();\n        }\n\n        if (animation !== null) {\n            animation.normalize();\n        }\n    }\n\n    stage.addChild(bg);\n\n    return {\n        col,\n        row,\n        resize: normalize,\n        isEmpty: () => tile === null,\n        hide: () => bg.visible = false,\n        setTile: (newTile) => {\n            if (tile) {\n                tile.remove();\n            }\n            tile = newTile;\n            tile.container.position.x = cellpos.x;\n            tile.container.position.y = cellpos.y;\n        },\n        animate: () => {\n            if (animation) {\n                if (animation.animate() === true) {\n                    animation = null;  // finished;\n                }\n            }\n            return animation === null;  // true when finished or nothing to animate\n        },\n        getValue: () => tile === null ? 0 : tile.value,\n        getIndex: () => tile === null ? null : tile.index,\n        getXpos: () => pos.x + unit.size*10*col,\n        getYpos: () => pos.y + unit.size*10*row,\n        getTile: () => tile,\n        moveTileUp: (toCell) => {\n            animation = AnimateMoveUp({toCell, tile, unit});\n            tile = null;\n        },\n        mergeTile: (withCell, direction) => {\n            animation = AnimateMerge({withCell, direction, tile, unit});\n            tile = null;\n        },\n        nextTile: () => {\n            if (tile !== null) {\n                const nextTile = tile.nextTile();\n                tile.container.parent.addChild(nextTile.container);\n                tile.remove();\n                tile = nextTile;\n                tile.container.position.x = cellpos.x;\n                tile.container.position.y = cellpos.y;\n            } else {\n                console.log(\"tile is null when calling `nextTile()`\");\n            }\n        }\n    }\n};\n\nexport default Cell;","const Highlight = (state) => {\n    const {offset, ok, nok, unit} = state;\n\n    let sprite = ok;\n    let col = null;\n\n    const normalize = () => {\n        if (col === null) {\n            ok.visible = false;\n            nok.visible = false;\n            return;\n        }\n        sprite.visible = true;\n        sprite.position.x = offset.x + 4*unit.size + col*10*unit.size;\n        sprite.position.y = offset.y + 9*unit.size;\n        sprite.width = 12*unit.size;\n        sprite.height = 72*unit.size;\n    }\n\n    return {\n        normalize,\n        update: (newCol, newSprite) => {\n            col = newCol;\n            if (sprite) {\n                sprite.visible = false;\n            }\n            sprite = newSprite;\n            normalize();\n        }\n    };\n};\n\nexport default Highlight;","import * as PIXI from \"pixi.js\";\nimport Cell from \"./Cell\";\nimport Highlight from \"./Highlight\";\n\n\nconst Grid = (state) => {\n    const {offset, stage, unit, score, tiles} = state;\n    const pos = {x: 0, y: 0, w: 50, h:70};\n    const cols = 5;\n    const rows = 8;  // 8 rows but only 7 visible\n    const cells = [];\n    const cellTexture = PIXI.Texture.from('assets/cell.png');\n    const okTexture = PIXI.Texture.from('assets/ok.png');\n    const nokTexture = PIXI.Texture.from('assets/nok.png');\n    const ok = new PIXI.Sprite(okTexture);\n    const nok = new PIXI.Sprite(nokTexture);\n    const highlight = Highlight({offset, ok, nok, unit});\n    let isAnimating = false;\n    let targetIndex = 11;  // 11 a good first target?\n\n    stage.addChild(ok);\n    stage.addChild(nok);\n\n    const normalize = () => {\n        pos.x = offset.x + unit.size*5;\n        pos.y = offset.y + unit.size*10;\n        pos.w = unit.size*50;\n        pos.h = unit.size*70;\n    }\n\n    normalize();\n\n    for (let row = 0; row < rows; row++) {\n        cells.push([]);\n        for (let col = 0; col < cols; col++) {\n            cells[row].push(Cell({stage, pos, unit, col, row, cellTexture}));\n        }\n    }\n\n    const lastRow = cells[rows-1];\n\n    lastRow.forEach(cell => cell.hide());\n\n    const resize = () => {\n        normalize();\n        highlight.normalize();\n        cells.forEach(row => row.forEach(cell => cell.resize()));\n    };\n\n    const colOnGrid = (mpos) => {\n        return (\n            mpos.x >= pos.x &&\n            mpos.x < pos.x + pos.w &&\n            mpos.y >= pos.y &&\n            mpos.y < pos.y + pos.h\n        ) ? Math.floor((mpos.x - pos.x) / (10*unit.size)) : null;\n    }\n\n    const colOkNok = (col, tile) => {\n        if (col === null) {\n            return ok;\n        }\n        let cell;\n        for (const row of cells) {\n            if (row === lastRow) {\n                break;\n            }\n            cell = row[col];\n            if (cell === undefined) {\n                console.log(\"undefined cell for col and row: \", col, row);\n                return nok;\n            }\n            if (cell.isEmpty()) {\n                return ok;\n            }\n        }\n        return cell.getIndex() === tile.index ? ok : nok;\n    }\n\n    const select = (mpos, tile) => {\n        if (tile === null) {\n            return;\n        }\n        const col = colOnGrid(mpos);\n        highlight.update(col, colOkNok(col, tile));\n    }\n\n    const final = (mpos, tile, cb) => {\n        const col = colOnGrid(mpos);\n        highlight.update(null);\n        if (col !== null && tile && colOkNok(col, tile) === ok) {\n            cb(col);\n        }\n    }\n\n    const getScore = () => cells.reduce((total, row) => row.reduce((total, cell) => total + cell.getValue(), total), 0);\n    const getMaxIndex = () => cells.reduce((ma, row) => row.reduce((ma, cell) => {\n        const cidx = cell.getIndex();\n        return cidx === null || cidx < ma ? ma : cidx;\n    }, ma), 0);\n    const getMinIndex = () => cells.reduce((mi, row) => row.reduce((mi, cell) => {\n        const cidx = cell.getIndex();\n        return cidx === null || cidx > mi ? mi : cidx;\n    }, mi), 999);\n\n    const cellsToAnimate = [];\n    const colsMoved = [];\n\n    const processGrid = () => {\n        // we never destoy cells, so do not care about references\n        cellsToAnimate.length = 0;\n\n        // update the score\n        score.update(getScore());\n\n        // calculate if tiles need to move up...\n        const toList = Array(cols).fill(0);\n        for (let r = 0; r < cells.length; r++) {\n            const row = cells[r];\n            for(let i = 0; i < row.length; ++i) {\n                const cell = row[i];\n                if (cell.isEmpty()) {\n                    toList[i] += 1;\n                } else {\n                    const n = toList[i];\n                    if (n > 0) {\n                        if (!colsMoved.includes(i)) {\n                            colsMoved.push(i);\n                        }\n                        cell.moveTileUp(cells[r-n][i]);\n                        cellsToAnimate.push(cell);\n                    }\n                }\n            }\n        }\n\n        if (cellsToAnimate.length) {\n            return;\n        }\n\n        // Merge check...\n        for (const i of colsMoved.slice().reverse()) {\n            for (let r = 0; r < rows-1; r++) {\n                const cell = cells[r][i];\n\n                if (cell.isEmpty()) {\n                    break;  // done with this row\n                }\n\n                const cellsToCheck = [\n                    {direction: \"right\", ce: i > 0 ? cells[r][i-1] : null},\n                    {direction: \"left\", ce: i < cols-1 ? cells[r][i+1] : null},\n                    {direction: \"up\", ce: cells[r+1][i]}\n                ];\n\n                cellsToCheck.forEach(({direction, ce}) => {\n                    if (ce !== null && !ce.isEmpty() && ce.getIndex() === cell.getIndex()) {\n                        if (direction === \"up\") {\n                            cell.mergeTile(ce, direction);\n                            cellsToAnimate.push(cell);\n                        } else {\n                            ce.mergeTile(cell, direction);\n                            cellsToAnimate.push(ce);\n                        }\n                    }\n\n                });\n            }\n        }\n\n        if (cellsToAnimate.length) {\n            return;\n        }\n\n        // done, get the next tile and reset moved cols\n        colsMoved.length = 0;\n        if (getMaxIndex() >= targetIndex) {\n            targetIndex += 2;\n            tiles.nextTarget();\n        }\n        tiles.newTile(getMinIndex());\n    };\n\n    const animate = () => {\n        isAnimating = false;\n        for (const cell of cellsToAnimate) {\n            if (cell.animate() === false) {\n                isAnimating = true;  // not finished animating\n            }\n        }\n        if (!isAnimating && cellsToAnimate.length > 0) {\n            // just finished animating, check for more\n            processGrid();\n        }\n    }\n\n    const addTile = (tile, col) => {\n        const cell = lastRow[col];\n        cell.setTile(tile);\n        if (!colsMoved.includes(col)) {\n            colsMoved.push(col);\n        }\n        processGrid();\n    }\n\n    return {\n        // draw: draw,\n        resize,\n        select,\n        move: select,\n        final,\n        addTile,\n        animate,\n    }\n};\n\nexport default Grid;","import * as PIXI from \"pixi.js\";\n\nconst Tile = (state) => {\n    const {index, allTiles, str, color, unit} = state;\n    const value = 2<<index;\n    const container = new PIXI.Container();\n    // var blur = new PIXI.filters.BlurFilter(0.5);\n    const graphics = new PIXI.Graphics();\n    // graphics.filters = [blur];\n\n    const style = new PIXI.TextStyle({\n        fontFamily: 'Arial',\n        fontSize: 32,\n        fontWeight: 'bold',\n        fill: '#ffffff',\n        align : 'center',\n        stroke: '#ffffff',\n        strokeThickness: 1,\n        lineJoin: 'round',\n    });\n\n    const text = new PIXI.Text(str, style);\n\n    const normalize = (isSmall) => {\n        const size = isSmall === true ? 7*unit.size : 10*unit.size;\n        graphics.clear();\n        graphics.lineStyle(0, color, 1);\n        graphics.beginFill(color, 1);\n        graphics.drawRoundedRect(1, 1, size-2, size-2, 0.5*unit.size);\n        graphics.endFill();\n        text.style.fontSize = isSmall === true ? 2.6*unit.size : 3.6*unit.size;\n        text.position.x = 0.5*size - text.width/2;\n        text.position.y = 0.27*size;\n    }\n\n    container.addChild(graphics);\n    container.addChild(text);\n\n    normalize();\n\n    return {\n        index,\n        value,\n        container,\n        normalize,\n        dupTile: () => Tile({index, allTiles, str, color, unit}),\n        nextTile: () => allTiles[index+1].dupTile(),\n        remove: () => container.parent ? container.parent.removeChild(container) : null,\n    };\n}\n\nexport default Tile;\n","import * as PIXI from \"pixi.js\";\nimport Tile from \"./Tile\";\n\nconst Tiles = (state) => {\n    const {offset, stage, unit} = state;\n\n    const tileRange = 6;\n    const allTiles = [];\n    const numTiles = [\n        '2', '4', '8', '16', '32', '64', '128', '256', '512',\n        '1K', '2K', '4K','8K', '16K', '32K', '64K', '128K', '256K', '512K',\n        '1M', '2M', '4M','8M', '16M', '32M', '64M', '128M', '256M', '512M',\n        '1T', '2T', '4T','8T', '16T', '32T', '64T', '128T', '256T', '512T',\n        '1P', '2P', '4P','8P', '16P', '32P', '64P', '128P', '256P', '512P',\n    ];\n    const rasterTexture = PIXI.Texture.from(\"assets/raster.png\");\n    const currentRaster = new PIXI.Sprite(rasterTexture);\n    const nextRaster = new PIXI.Sprite(rasterTexture);\n\n    let minTileIndex = 0;\n\n    const randColor = (index) => {\n        const red = (Math.floor(Math.random() * 0x50) + ((index&1)?0x20:0x70)) << 16;\n        const green = (Math.floor(Math.random() * 0x50) + ((index&2)?0x20:0x70)) << 8;\n        const blue = (Math.floor(Math.random() * 0x50) + ((index&4)?0x20:0x70)) << 0;\n\n        return red+green+blue;\n    }\n\n    for (let index = 0; index < numTiles.length; ++index) {\n        const color = randColor(index);\n        const str = numTiles[index];\n        // console.log('index: ', index, color.toString(16).padStart(6, 0));\n        allTiles.push(Tile({index, allTiles, str, color, unit}));\n    }\n\n    const renderTiles = () => {\n        let i = 0;\n        for (const tile of allTiles) {\n            stage.addChild(tile.container);\n            tile.container.position.x = 100*Math.floor(i/8);\n            tile.container.position.y = 100*Math.floor(i%8);\n            i++;\n        }\n    }\n\n    const getRandomTile = (mi) => {\n        // Update mi\n        mi = current && current.index < mi ? current.index : mi;\n        let diff;\n        if (mi < minTileIndex) {\n            diff = minTileIndex-mi;\n        } else {\n            diff = 0;\n            mi = minTileIndex;\n        }\n\n        const idx = Math.floor(Math.random() * (tileRange+diff)) + mi;\n        return allTiles[idx].dupTile();\n    }\n\n    let current = null;\n    let next = null;\n\n    const normalizeTiles = () => {\n        if (current) {\n            current.container.position.x = offset.x + unit.size*25;\n            current.container.position.y = offset.y + unit.size*85;\n            current.normalize();\n        }\n        next.container.position.x = offset.x + unit.size*36.5;\n        next.container.position.y = offset.y + unit.size*86.5;\n        next.normalize(true);\n    }\n\n    const normalize = () => {\n        currentRaster.position.x = offset.x + unit.size*24;\n        currentRaster.position.y = offset.y + unit.size*84;\n        currentRaster.width = unit.size*12;\n        currentRaster.height = unit.size*12;\n\n        nextRaster.position.x = offset.x + unit.size*36;\n        nextRaster.position.y = offset.y + unit.size*86;\n        nextRaster.width = unit.size*8;\n        nextRaster.height = unit.size*8;\n\n        normalizeTiles();\n    }\n\n    const newTile = (mi) => {\n        current = next;\n        next = getRandomTile(mi);\n        stage.addChild(next.container);\n        normalizeTiles();\n    };\n\n    stage.addChild(currentRaster);\n    stage.addChild(nextRaster);\n\n    return {\n        renderTiles,\n        newTile,\n        getCurrentTile: () => current,\n        stealCurrentTile: () => {\n            const tile = current;\n            current = null;\n            return tile;\n        },\n        resize: normalize,\n        nextTarget: () => minTileIndex++,\n    }\n};\n\nexport default Tiles;","import * as PIXI from \"pixi.js\";\n\nconst Score = (state) => {\n    const {offset, stage, unit} = state;\n\n    const style = new PIXI.TextStyle({\n        fontFamily: 'Arial',\n        fontSize: 32,\n        fontStyle: 'italic',\n        fontWeight: 'bold',\n        fill: '#eeeeee',\n        align : 'center',\n        stroke: '#ffffff',\n        strokeThickness: 2,\n        lineJoin: 'round',\n    });\n\n    const text = new PIXI.Text((0).toLocaleString(), style);\n\n    const normalize = () => {\n        text.x = offset.x + 30*unit.size - text.width/2;\n        text.y = offset.y + 1*unit.size;\n    }\n\n    stage.addChild(text);\n\n    return {\n        resize: normalize,\n        update: (score) => {\n            const str = (score).toLocaleString();\n            text.text = str;\n            normalize();\n        }\n    };\n}\n\nexport default Score;\n","import './index.css';\nimport * as serviceWorker from './serviceWorker';\nimport Game from \"./Game\";\n\nconst game = Game({\n    container: document.body\n});\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n\n\nwindow.addEventListener('resize', game.resize);\n\ngame.animate();\n","import * as PIXI from \"pixi.js\";\nimport Grid from \"./Grid\";\nimport Tiles from \"./Tiles\";\nimport Score from \"./Score\";\n\nconst version = \"v1.0.2\";\n\nconst Game = (state) => {\n    let container = state.container;\n    let unit = {size: 10}, offset = {x: 0, y: 0};\n\n    const app = new PIXI.Application({\n        width: window.innerWidth,\n        height: window.innerHeight\n    });\n\n    // Add the canvas that Pixi automatically created for you to the HTML document\n    container.appendChild(app.view);\n\n    // Configure app\n    app.renderer.view.style.position = \"absolute\";\n    app.renderer.view.style.display = \"block\";\n    app.renderer.view.style.backgroundColor = \"#823456\";\n    app.renderer.autoResize = true;\n\n    const stage = new PIXI.Container();\n\n    stage.interactive = true;\n\n    const onPointerDown = (event) => {\n        const pos = event.data.getLocalPosition(stage);\n        grid.select(pos, tiles.getCurrentTile());\n    };\n\n    const onPointerMove = (event) => {\n        const pos = event.data.getLocalPosition(stage);\n        grid.move(pos, tiles.getCurrentTile());\n    };\n\n    const placeTile = (col) => {\n        const tile = tiles.stealCurrentTile();\n        if (!tile) {\n            return;\n        }\n\n        grid.addTile(tile, col);\n        grid.animate()\n    }\n\n    const onPointerUp = (event) => {\n        const pos = event.data.getLocalPosition(stage);\n        grid.final(pos, tiles.getCurrentTile(), placeTile);\n    };\n\n    stage\n        .on('pointerdown', onPointerDown)\n        .on('pointermove', onPointerMove)\n        .on('pointerup', onPointerUp);\n\n    const normalize = () => {\n        let ww = window.innerWidth;\n        let wh = window.innerHeight;\n        let nh = wh * (6/10);\n\n        if (ww < nh) {\n            unit.size = ww / 60;\n            offset.x = 0;\n            offset.y = (wh - (unit.size * 100)) / 2;\n        } else {\n            unit.size = wh / 100;\n            offset.x = (ww - (unit.size * 60)) / 2;;\n            offset.y = 0;\n        }\n    }\n\n    const tiles = Tiles({offset, stage, unit});\n    const score = Score({offset, stage, unit});\n    const grid = Grid({unit, offset, stage, score, tiles});\n\n    const style = new PIXI.TextStyle({\n        fontFamily: 'Arial',\n        fontSize: 16,\n        fontStyle: 'normal',\n        fontWeight: 'normal',\n        fill: '#999999',\n        align : 'center',\n        stroke: '#999999',\n        strokeThickness: 2,\n        lineJoin: 'round',\n    });\n\n    const text = new PIXI.Text(version, style);\n    text.position.x = 10;\n    text.position.y = 10;\n    stage.addChild(text);\n\n    tiles.newTile(0);\n    tiles.newTile(0);\n\n    const animate = () => {\n        requestAnimationFrame(animate);\n\n        grid.animate();\n\n        app.renderer.render(stage);\n    }\n\n    // tiles.renderTiles();\n\n    normalize();\n    grid.resize();\n    tiles.resize();\n    score.resize();\n\n    return {\n        resize: () => {\n            normalize();\n            score.resize();\n            grid.resize();\n            tiles.resize();\n            app.renderer.resize(window.innerWidth, window.innerHeight);\n        },\n        animate: animate\n    }\n};\n\n\nexport default Game;"],"sourceRoot":""}