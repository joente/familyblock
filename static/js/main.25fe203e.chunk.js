(this.webpackJsonppixitest=this.webpackJsonppixitest||[]).push([[0],{10:function(e,n,i){e.exports=i(21)},11:function(e,n,i){},21:function(e,n,i){"use strict";i.r(n);i(11),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var t=i(0),r=i(1),o=function(e){var n=e.tile,i=e.toCell,t=e.unit,r={target:0,speed:-1},o=function(){r.target=i.getYpos(),r.speed=-5*t.size,n.width=10*t.size,n.height=10*t.size};o();return{animate:function(){return n.container.position.y+=r.speed,n.container.position.y<=r.target&&(i.setTile(n),!0)},normalize:o}},a=function(e){var n=e.tile,i=e.withCell,t=e.direction,r=e.unit,o={target:0,speed:0},a=function(){switch(t){case"up":o.target=i.getYpos();break;case"right":case"left":o.target=i.getXpos();break;default:console.log("unknown direction: ",t)}o.speed=1*r.size,n.width=10*r.size,n.height=10*r.size};a();return{animate:function(){var e=!1;switch(t){case"up":n.container.position.y+=o.speed,e=n.container.position.y>=o.target;break;case"right":n.container.position.x+=o.speed,e=n.container.position.x>=o.target;break;case"left":n.container.position.x-=o.speed,e=n.container.position.x<=o.target;break;default:console.log("unknown direction: ",t)}return!!e&&(n.remove(),i.nextTile(),!0)},normalize:a}},l=function(e){var n=e.stage,i=e.pos,r=e.unit,l=e.col,s=e.row,u=e.cellTexture,c=new t.d(u),f={x:0,y:0,size:0},d=null,h=null;return n.addChild(c),{col:l,row:s,resize:function(){f.x=i.x+10*r.size*l,f.y=i.y+10*r.size*s,f.size=10*r.size,c.visible&&(c.position.x=f.x,c.position.y=f.y,c.width=c.height=f.size),null!==d&&(d.container.position.x=f.x,d.container.position.y=f.y,d.normalize()),null!==h&&h.normalize()},isEmpty:function(){return null===d},hide:function(){return c.visible=!1},setTile:function(e){d&&d.remove(),(d=e).container.position.x=f.x,d.container.position.y=f.y},animate:function(){return h&&!0===h.animate()&&(h=null),null===h},getValue:function(){return null===d?0:d.value},getIndex:function(){return null===d?null:d.index},getXpos:function(){return i.x+10*r.size*l},getYpos:function(){return i.y+10*r.size*s},getTile:function(){return d},moveTileUp:function(e){h=o({toCell:e,tile:d,unit:r}),d=null},mergeTile:function(e,n){h=a({withCell:e,direction:n,tile:d,unit:r}),d=null},nextTile:function(){var e=d.nextTile();d.container.parent.addChild(e.container),d.remove(),(d=e).container.position.x=f.x,d.container.position.y=f.y}}},s=function(e){var n=e.offset,i=e.ok,t=e.nok,r=e.unit,o=i,a=null,l=function(){if(null===a)return i.visible=!1,void(t.visible=!1);o.visible=!0,o.position.x=n.x+4*r.size+10*a*r.size,o.position.y=n.y+9*r.size,o.width=12*r.size,o.height=72*r.size};return{normalize:l,update:function(e,n){a=e,o&&(o.visible=!1),o=n,l()}}},u=function(e){var n=e.offset,i=e.stage,o=e.unit,a=e.score,u=e.tiles,c={x:0,y:0,w:50,h:70},f=[],d=t.g.from("assets/cell.png"),h=t.g.from("assets/ok.png"),p=t.g.from("assets/nok.png"),g=new t.d(h),v=new t.d(p),z=s({offset:n,ok:g,nok:v,unit:o}),x=!1,w=11;i.addChild(g),i.addChild(v);var y=function(){c.x=n.x+5*o.size,c.y=n.y+10*o.size,c.w=50*o.size,c.h=70*o.size};y();for(var m=0;m<8;m++){f.push([]);for(var T=0;T<5;T++)f[m].push(l({stage:i,pos:c,unit:o,col:T,row:m,cellTexture:d}))}var b=f[7];b.forEach((function(e){return e.hide()}));var k=function(e){return e.x>=c.x&&e.x<=c.x+c.w&&e.y>=c.y&&e.y<=c.y+c.h?Math.floor((e.x-c.x)/(10*o.size)):null},C=function(e,n){if(null===e)return g;var i,t,o=Object(r.a)(f);try{for(o.s();!(t=o.n()).done;){var a=t.value;if(a===b)break;if((i=a[e]).isEmpty())return g}}catch(l){o.e(l)}finally{o.f()}return i.getIndex()===n.index?g:v},M=function(e,n){if(null!==n){var i=k(e);z.update(i,C(i,n))}},P=[],E=Array(5).fill(!1),K=function(){P.length=0,a.update(f.reduce((function(e,n){return n.reduce((function(e,n){return e+n.getValue()}),e)}),0));for(var e=Array(5).fill(0),n=0;n<f.length;n++)for(var i=f[n],t=0;t<i.length;++t){var r=i[t];if(r.isEmpty())e[t]+=1;else{var o=e[t];o>0&&(E[t]=!0,r.moveTileUp(f[n-o][t]),P.push(r))}}if(!P.length){for(var l=0;l<E.length;l++)if(!1!==E[l])for(var s=function(e){var n=f[e][l];if(n.isEmpty())return"break";[{direction:"right",ce:l>0?f[e][l-1]:null},{direction:"left",ce:l<4?f[e][l+1]:null},{direction:"up",ce:f[e+1][l]}].forEach((function(e){var i=e.direction,t=e.ce;null===t||t.isEmpty()||t.getIndex()!==n.getIndex()||("up"===i?(n.mergeTile(t,i),P.push(n)):(t.mergeTile(n,i),P.push(t)))}))},c=0;c<7;c++){if("break"===s(c))break}P.length||(E.fill(!1),f.reduce((function(e,n){return n.reduce((function(e,n){var i=n.getIndex();return null===i||i<e?e:i}),e)}),0)>=w&&(w+=2,u.nextTarget()),u.newTile(f.reduce((function(e,n){return n.reduce((function(e,n){var i=n.getIndex();return null===i||i>e?e:i}),e)}),999)))}};return{resize:function(){y(),z.normalize(),f.forEach((function(e){return e.forEach((function(e){return e.resize()}))}))},select:M,move:M,final:function(e,n,i){var t=k(e);z.update(null),null!==t&&n&&C(t,n)===g&&i(t)},addTile:function(e,n){b[n].setTile(e),E[n]=!0,K()},animate:function(){x=!1;var e,n=Object(r.a)(P);try{for(n.s();!(e=n.n()).done;){!1===e.value.animate()&&(x=!0)}}catch(i){n.e(i)}finally{n.f()}!x&&P.length>0&&K()}}},c=function e(n){var i=n.index,r=n.allTiles,o=n.str,a=n.color,l=n.unit,s=2<<i,u=new t.b,c=new t.h.BlurFilter(1),f=new t.c;f.filters=[c];var d=new t.f({fontFamily:"Arial",fontSize:32,fontWeight:"bold",fill:"#ffffff",align:"center",stroke:"#ffffff",strokeThickness:2,lineJoin:"round"}),h=new t.e(o,d),p=function(e){var n=!0===e?7*l.size:10*l.size;f.clear(),f.lineStyle(0,a,1),f.beginFill(a,1),f.drawRoundedRect(1,1,n-2,n-2,.5*l.size),f.endFill(),h.style.fontSize=!0===e?2.6*l.size:3.6*l.size,h.position.x=.5*n-h.width/2,h.position.y=.27*n};return u.addChild(f),u.addChild(h),p(),{index:i,value:s,container:u,normalize:p,dupTile:function(){return e({index:i,allTiles:r,str:o,color:a,unit:l})},nextTile:function(){return r[i+1].dupTile()},remove:function(){return u.parent.removeChild(u)}}},f=function(e){for(var n=e.offset,i=e.stage,o=e.unit,a=[],l=["2","4","8","16","32","64","128","256","512","1K","2K","4K","8K","16K","32K","64K","128K","256K","512K","1M","2M","4M","8M","16M","32M","64M","128M","256M","512M","1T","2T","4T","8T","16T","32T","64T","128T","256T","512T","1P","2P","4P","8P","16P","32P","64P","128P","256P","512P"],s=t.g.from("assets/raster.png"),u=new t.d(s),f=new t.d(s),d=0,h=function(e){return(Math.floor(80*Math.random())+(1&e?32:112)<<16)+(Math.floor(80*Math.random())+(2&e?32:112)<<8)+(Math.floor(80*Math.random())+(4&e?32:112)<<0)},p=0;p<l.length;++p){var g=h(p),v=l[p];a.push(c({index:p,allTiles:a,str:v,color:g,unit:o}))}var z=null,x=null,w=function(){z&&(z.container.position.x=n.x+25*o.size,z.container.position.y=n.y+85*o.size,z.normalize()),x.container.position.x=n.x+36.5*o.size,x.container.position.y=n.y+86.5*o.size,x.normalize(!0)};return i.addChild(u),i.addChild(f),{renderTiles:function(){var e,n=0,t=Object(r.a)(a);try{for(t.s();!(e=t.n()).done;){var o=e.value;i.addChild(o.container),o.container.position.x=100*Math.floor(n/8),o.container.position.y=100*Math.floor(n%8),n++}}catch(l){t.e(l)}finally{t.f()}},newTile:function(e){z=x,x=function(e){var n;(e=z&&z.index<e?z.index:e)<d?n=d-e:(n=0,e=d);var i=Math.floor(Math.random()*(6+n))+e;return a[i].dupTile()}(e),i.addChild(x.container),w()},getCurrentTile:function(){return z},stealCurrentTile:function(){var e=z;return z=null,e},resize:function(){u.position.x=n.x+24*o.size,u.position.y=n.y+84*o.size,u.width=12*o.size,u.height=12*o.size,f.position.x=n.x+36*o.size,f.position.y=n.y+86*o.size,f.width=8*o.size,f.height=8*o.size,w()},nextTarget:function(){return d++}}},d=function(e){var n=e.offset,i=e.stage,r=e.unit,o=new t.f({fontFamily:"Arial",fontSize:32,fontStyle:"italic",fontWeight:"bold",fill:"#eeeeee",align:"center",stroke:"#ffffff",strokeThickness:2,lineJoin:"round"}),a=new t.e((0).toLocaleString(),o),l=function(){a.x=n.x+30*r.size-a.width/2,a.y=n.y+1*r.size};return i.addChild(a),{resize:l,update:function(e){var n=e.toLocaleString();a.text=n,l()}}},h=function(e){var n=e.container,i={size:10},r={x:0,y:0},o=new t.a({width:window.innerWidth,height:window.innerHeight});n.appendChild(o.view),o.renderer.view.style.position="absolute",o.renderer.view.style.display="block",o.renderer.view.style.backgroundColor="#823456",o.renderer.autoResize=!0;var a=new t.b;a.interactive=!0;var l=function(e){var n=c.stealCurrentTile();n&&(p.addTile(n,e),p.animate())};a.on("pointerdown",(function(e){var n=e.data.getLocalPosition(a);p.select(n,c.getCurrentTile())})).on("pointermove",(function(e){var n=e.data.getLocalPosition(a);p.move(n,c.getCurrentTile())})).on("pointerup",(function(e){var n=e.data.getLocalPosition(a);p.final(n,c.getCurrentTile(),l)}));var s=function(){var e=window.innerWidth,n=window.innerHeight;e<.6*n?(i.size=e/60,r.x=0,r.y=(n-100*i.size)/2):(i.size=n/100,r.x=(e-60*i.size)/2,r.y=0)},c=f({offset:r,stage:a,unit:i}),h=d({offset:r,stage:a,unit:i}),p=u({unit:i,offset:r,stage:a,score:h,tiles:c});c.newTile(0),c.newTile(0);return s(),p.resize(),c.resize(),h.resize(),{resize:function(){s(),h.resize(),p.resize(),c.resize(),o.renderer.resize(window.innerWidth,window.innerHeight)},animate:function e(){requestAnimationFrame(e),p.animate(),o.renderer.render(a)}}}({container:document.body});"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),window.addEventListener("resize",h.resize),h.animate()}},[[10,1,2]]]);
//# sourceMappingURL=main.25fe203e.chunk.js.map