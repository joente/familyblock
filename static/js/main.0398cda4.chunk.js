(this.webpackJsonppixitest=this.webpackJsonppixitest||[]).push([[0],{10:function(e,n,i){e.exports=i(21)},11:function(e,n,i){},21:function(e,n,i){"use strict";i.r(n);i(11),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var t=i(0),o=i(1),r=function(e){var n=e.tile,i=e.toCell,t=e.unit,o={target:0,speed:-1},r=function(){o.target=i.getYpos(),o.speed=-5*t.size,n.width=10*t.size,n.height=10*t.size};r();return{animate:function(){return n.container.position.y+=o.speed,n.container.position.y<=o.target&&(i.setTile(n),!0)},normalize:r}},l=function(e){var n=e.tile,i=e.withCell,t=e.direction,o=e.unit,r={target:0,speed:0},l=function(){switch(t){case"up":r.target=i.getYpos();break;case"right":case"left":r.target=i.getXpos();break;default:console.log("unknown direction: ",t)}r.speed=1*o.size,n.width=10*o.size,n.height=10*o.size};l();return{animate:function(){var e=!1;switch(t){case"up":n.container.position.y+=r.speed,e=n.container.position.y>=r.target;break;case"right":n.container.position.x+=r.speed,e=n.container.position.x>=r.target;break;case"left":n.container.position.x-=r.speed,e=n.container.position.x<=r.target;break;default:console.log("unknown direction: ",t)}return!!e&&(n.remove(),i.nextTile(),!0)},normalize:l}},a=function(e){var n=e.stage,i=e.pos,o=e.unit,a=e.col,s=e.row,u=e.cellTexture,c=new t.d(u),f={x:0,y:0,size:0},d=null,h=null;return n.addChild(c),{col:a,row:s,resize:function(){f.x=i.x+10*o.size*a,f.y=i.y+10*o.size*s,f.size=10*o.size,c.visible&&(c.position.x=f.x,c.position.y=f.y,c.width=c.height=f.size),null!==d&&(d.container.position.x=f.x,d.container.position.y=f.y,d.normalize()),null!==h&&h.normalize()},isEmpty:function(){return null===d},hide:function(){return c.visible=!1},setTile:function(e){d&&d.remove(),(d=e).container.position.x=f.x,d.container.position.y=f.y},animate:function(){return h&&!0===h.animate()&&(h=null),null===h},getValue:function(){return null===d?0:d.value},getIndex:function(){return null===d?null:d.index},getXpos:function(){return i.x+10*o.size*a},getYpos:function(){return i.y+10*o.size*s},getTile:function(){return d},moveTileUp:function(e){h=r({toCell:e,tile:d,unit:o}),d=null},mergeTile:function(e,n){h=l({withCell:e,direction:n,tile:d,unit:o}),d=null},nextTile:function(){var e=d.nextTile();d.container.parent.addChild(e.container),d.remove(),(d=e).container.position.x=f.x,d.container.position.y=f.y}}},s=function(e){var n=e.offset,i=e.ok,t=e.nok,o=e.unit,r=i,l=null,a=function(){if(null===l)return i.visible=!1,void(t.visible=!1);r.visible=!0,r.position.x=n.x+4*o.size+10*l*o.size,r.position.y=n.y+9*o.size,r.width=12*o.size,r.height=72*o.size};return{normalize:a,update:function(e,n){l=e,r&&(r.visible=!1),r=n,a()}}},u=function(e){var n=e.offset,i=e.stage,r=e.unit,l=e.score,u=e.tiles,c={x:0,y:0,w:50,h:70},f=[],d=t.g.from("assets/cell.png"),h=t.g.from("assets/ok.png"),g=t.g.from("assets/nok.png"),p=new t.d(h),v=new t.d(g),z=s({offset:n,ok:p,nok:v,unit:r}),w=!1;i.addChild(p),i.addChild(v);var x=function(){c.x=n.x+5*r.size,c.y=n.y+10*r.size,c.w=50*r.size,c.h=70*r.size};x();for(var y=0;y<8;y++){f.push([]);for(var m=0;m<5;m++)f[y].push(a({stage:i,pos:c,unit:r,col:m,row:y,cellTexture:d}))}var T=f[7];T.forEach((function(e){return e.hide()}));var k=function(e){return e.x>=c.x&&e.x<=c.x+c.w&&e.y>=c.y&&e.y<=c.y+c.h?Math.floor((e.x-c.x)/(10*r.size)):null},b=function(e,n){if(null===e)return p;var i,t,r=Object(o.a)(f);try{for(r.s();!(t=r.n()).done;){var l=t.value;if(l===T)break;if(void 0===(i=l[e])&&console.log(e),i.isEmpty())return p}}catch(a){r.e(a)}finally{r.f()}return i.getIndex()===n.index?p:v},C=function(e,n){if(null!==n){var i=k(e);z.update(i,b(i,n))}},M=function(){return f.reduce((function(e,n){return n.reduce((function(e,n){return e+n.getValue()}),e)}),0)},P=[],S=Array(5).fill(!1),E=function(){P.length=0,l.update(M());for(var e=Array(5).fill(0),n=0;n<f.length;n++)for(var i=f[n],t=0;t<i.length;++t){var o=i[t];if(o.isEmpty())e[t]+=1;else{var r=e[t];r>0&&(S[t]=!0,o.moveTileUp(f[n-r][t]),P.push(o))}}if(!P.length){console.log("Merge check...",S);for(var a=0;a<S.length;a++)if(!1!==S[a])for(var s=function(e){var n=f[e][a];if(n.isEmpty())return"break";console.log("Cell index to check: ",e,a,n.getIndex());var i=[{direction:"right",ce:a>0?f[e][a-1]:null},{direction:"left",ce:a<4?f[e][a+1]:null},{direction:"up",ce:f[e+1][a]}];console.log("toCheck: ",i),i.forEach((function(e){var i=e.direction,t=e.ce;null===t||t.isEmpty()||t.getIndex()!==n.getIndex()||(console.log("Animate merge: ",i,t.row," to ",n.row),"up"===i?(n.mergeTile(t,i),P.push(n)):(t.mergeTile(n,i),P.push(t)))}))},c=0;c<7;c++){if("break"===s(c))break}P.length||(S.fill(!1),u.newTile(0))}};return{resize:function(){x(),z.normalize(),f.forEach((function(e){return e.forEach((function(e){return e.resize()}))}))},select:C,move:C,final:function(e,n,i){var t=k(e);z.update(null),null!==t&&n&&b(t,n)===p&&i(t)},addTile:function(e,n){T[n].setTile(e),S[n]=!0,E()},animate:function(){w=!1;var e,n=Object(o.a)(P);try{for(n.s();!(e=n.n()).done;){!1===e.value.animate()&&(w=!0)}}catch(i){n.e(i)}finally{n.f()}!w&&P.length>0&&E()},getScore:M}},c=function e(n){var i=n.index,o=n.allTiles,r=n.str,l=n.color,a=n.unit,s=2<<i,u=new t.b,c=new t.h.BlurFilter(1),f=new t.c;f.filters=[c];var d=new t.f({fontFamily:"Arial",fontSize:32,fontWeight:"bold",fill:"#ffffff",align:"center",stroke:"#ffffff",strokeThickness:2,lineJoin:"round"});console.log(l);var h=new t.e(r,d),g=function(e){var n=!0===e?7*a.size:10*a.size;f.clear(),f.lineStyle(0,l,1),f.beginFill(l,1),f.drawRoundedRect(1,1,n-2,n-2,.5*a.size),f.endFill(),h.style.fontSize=!0===e?2.6*a.size:3.6*a.size,h.position.x=.5*n-h.width/2,h.position.y=.27*n};return u.addChild(f),u.addChild(h),g(),{index:i,value:s,container:u,normalize:g,dupTile:function(){return e({index:i,allTiles:o,str:r,color:l,unit:a})},nextTile:function(){return console.log(o,i),o[i+1].dupTile()},remove:function(){return u.parent.removeChild(u)}}},f=function(e){for(var n=e.offset,i=e.stage,r=e.unit,l=[],a=["2","4","8","16","32","64","128","256","512","1K","2K","4K","8K","16K","32K","64K","128K","256K","512K","1M","2M","4M","8M","16M","32M","64M","128M","256M","512M","1T","2T","4T","8T","16T","32T","64T","128T","256T","512T","1P","2P","4P","8P","16P","32P","64P","128P","256P","512P"],s=t.g.from("assets/raster.png"),u=new t.d(s),f=new t.d(s),d=function(e){return console.log(!!(1&e)),(Math.floor(80*Math.random())+(1&e?32:112)<<16)+(Math.floor(80*Math.random())+(2&e?32:112)<<8)+(Math.floor(80*Math.random())+(4&e?32:112)<<0)},h=0;h<a.length;++h){var g=d(h),p=a[h];console.log("index: ",h,g.toString(16).padStart(6,0)),l.push(c({index:h,allTiles:l,str:p,color:g,unit:r}))}var v=null,z=null,w=function(){v&&(v.container.position.x=n.x+25*r.size,v.container.position.y=n.y+85*r.size,v.normalize()),z.container.position.x=n.x+36.5*r.size,z.container.position.y=n.y+86.5*r.size,z.normalize(!0)};return i.addChild(u),i.addChild(f),{renderTiles:function(){var e,n=0,t=Object(o.a)(l);try{for(t.s();!(e=t.n()).done;){var r=e.value;i.addChild(r.container),r.container.position.x=100*Math.floor(n/8),r.container.position.y=100*Math.floor(n%8),n++}}catch(a){t.e(a)}finally{t.f()}},newTile:function(e){v=z,z=function(e){e=v&&v.index<e?v.index:0,e=z&&z.index<e?z.index:e;var n=Math.floor(6*Math.random())+e;return l[n].dupTile()}(e),console.log(z),i.addChild(z.container),w()},getCurrentTile:function(){return v},stealCurrentTile:function(){var e=v;return v=null,e},resize:function(){u.position.x=n.x+24*r.size,u.position.y=n.y+84*r.size,u.width=12*r.size,u.height=12*r.size,f.position.x=n.x+36*r.size,f.position.y=n.y+86*r.size,f.width=8*r.size,f.height=8*r.size,w()}}},d=function(e){var n=e.offset,i=e.stage,o=e.unit,r=new t.f({fontFamily:"Arial",fontSize:32,fontStyle:"italic",fontWeight:"bold",fill:"#eeeeee",align:"center",stroke:"#ffffff",strokeThickness:2,lineJoin:"round"}),l=new t.e((0).toLocaleString(),r),a=function(){l.x=n.x+30*o.size-l.width/2,l.y=n.y+1*o.size};return i.addChild(l),{resize:a,update:function(e){var n=e.toLocaleString();console.log("update score: ",e),l.text=n,a()}}},h=function(e){var n=e.container,i={size:10},o={x:0,y:0},r=new t.a({width:window.innerWidth,height:window.innerHeight});n.appendChild(r.view),r.renderer.view.style.position="absolute",r.renderer.view.style.display="block",r.renderer.view.style.backgroundColor="#823456",r.renderer.autoResize=!0;var l=new t.b;l.interactive=!0;var a=function(e){var n=c.stealCurrentTile();n&&(g.addTile(n,e),h.update(g.getScore()),g.animate())};l.on("pointerdown",(function(e){var n=e.data.getLocalPosition(l);g.select(n,c.getCurrentTile())})).on("pointermove",(function(e){var n=e.data.getLocalPosition(l);g.move(n,c.getCurrentTile())})).on("pointerup",(function(e){var n=e.data.getLocalPosition(l);g.final(n,c.getCurrentTile(),a)}));var s=function(){var e=window.innerWidth,n=window.innerHeight;e<.6*n?(i.size=e/60,o.x=0,o.y=(n-100*i.size)/2):(i.size=n/100,o.x=(e-60*i.size)/2,o.y=0)},c=f({offset:o,stage:l,unit:i}),h=d({offset:o,stage:l,unit:i}),g=u({unit:i,offset:o,stage:l,score:h,tiles:c});c.newTile(0),c.newTile(0);return s(),g.resize(),c.resize(),h.resize(),{resize:function(){s(),h.resize(),g.resize(),c.resize(),r.renderer.resize(window.innerWidth,window.innerHeight)},animate:function e(){requestAnimationFrame(e),g.animate(),r.renderer.render(l)}}}({container:document.body});"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),window.addEventListener("resize",h.resize),h.animate()}},[[10,1,2]]]);
//# sourceMappingURL=main.0398cda4.chunk.js.map