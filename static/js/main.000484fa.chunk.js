(this.webpackJsonpfamilyblock=this.webpackJsonpfamilyblock||[]).push([[0],{10:function(e,n,i){e.exports=i(21)},11:function(e,n,i){},21:function(e,n,i){"use strict";i.r(n);i(11);var t=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function o(e,n){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var i=e.installing;null!=i&&(i.onstatechange=function(){"installed"===i.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var r=i(0),a=i(1),l=function(e){var n=e.tile,i=e.toCell,t=e.unit,o={target:0,speed:-1},r=function(){o.target=i.getYpos(),o.speed=-5*t.size,n.width=10*t.size,n.height=10*t.size};r();return{animate:function(){return n.container.position.y+=o.speed,n.container.position.y<=o.target&&(i.setTile(n),!0)},normalize:r}},s=function(e){var n=e.tile,i=e.withCell,t=e.direction,o=e.unit,r={target:0,speed:0},a=function(){switch(t){case"up":r.target=i.getYpos();break;case"right":case"left":r.target=i.getXpos();break;default:console.log("unknown direction: ",t)}r.speed=1*o.size,n.width=10*o.size,n.height=10*o.size};a();return{animate:function(){var e=!1;switch(t){case"up":n.container.position.y+=r.speed,e=n.container.position.y>=r.target;break;case"right":n.container.position.x+=r.speed,e=n.container.position.x>=r.target;break;case"left":n.container.position.x-=r.speed,e=n.container.position.x<=r.target;break;default:console.log("unknown direction: ",t)}return!!e&&(n.remove(),i.nextTile(),!0)},normalize:a}},u=function(e){var n=e.stage,i=e.pos,t=e.unit,o=e.col,a=e.row,u=e.cellTexture,c=new r.d(u),f={x:0,y:0,size:0},d=null,h=null;return n.addChild(c),{col:o,row:a,resize:function(){f.x=i.x+10*t.size*o,f.y=i.y+10*t.size*a,f.size=10*t.size,c.visible&&(c.position.x=f.x,c.position.y=f.y,c.width=c.height=f.size),null!==d&&(d.container.position.x=f.x,d.container.position.y=f.y,d.normalize()),null!==h&&h.normalize()},isEmpty:function(){return null===d},hide:function(){return c.visible=!1},setTile:function(e){d&&d.remove(),(d=e).container.position.x=f.x,d.container.position.y=f.y},animate:function(){return h&&!0===h.animate()&&(h=null),null===h},getValue:function(){return null===d?0:d.value},getIndex:function(){return null===d?null:d.index},getXpos:function(){return i.x+10*t.size*o},getYpos:function(){return i.y+10*t.size*a},getTile:function(){return d},moveTileUp:function(e){h=l({toCell:e,tile:d,unit:t}),d=null},mergeTile:function(e,n){h=s({withCell:e,direction:n,tile:d,unit:t}),d=null},nextTile:function(){if(null!==d){var e=d.nextTile();d.container.parent.addChild(e.container),d.remove(),(d=e).container.position.x=f.x,d.container.position.y=f.y}else console.log("tile is null when calling `nextTile()`")}}},c=function(e){var n=e.offset,i=e.ok,t=e.nok,o=e.unit,r=i,a=null,l=function(){if(null===a)return i.visible=!1,void(t.visible=!1);r.visible=!0,r.position.x=n.x+4*o.size+10*a*o.size,r.position.y=n.y+9*o.size,r.width=12*o.size,r.height=72*o.size};return{normalize:l,update:function(e,n){a=e,r&&(r.visible=!1),r=n,l()}}},f=function(e){var n=e.offset,i=e.stage,t=e.unit,o=e.score,l=e.tiles,s={x:0,y:0,w:50,h:70},f=[],d=r.g.from("assets/cell.png"),h=r.g.from("assets/ok.png"),p=r.g.from("assets/nok.png"),g=new r.d(h),v=new r.d(p),w=c({offset:n,ok:g,nok:v,unit:t}),z=!1,y=9;i.addChild(g),i.addChild(v);var x=function(){s.x=n.x+5*t.size,s.y=n.y+10*t.size,s.w=50*t.size,s.h=70*t.size};x();for(var m=0;m<8;m++){f.push([]);for(var T=0;T<5;T++)f[m].push(u({stage:i,pos:s,unit:t,col:T,row:m,cellTexture:d}))}var b=f[7];b.forEach((function(e){return e.hide()}));var k=function(e){return e.x>=s.x&&e.x<s.x+s.w&&e.y>=s.y&&e.y<s.y+s.h?Math.floor((e.x-s.x)/(10*t.size)):null},C=function(e,n){if(null===e)return g;var i,t,o=Object(a.a)(f);try{for(o.s();!(t=o.n()).done;){var r=t.value;if(r===b)break;if(void 0===(i=r[e]))return console.log("undefined cell for col and row: ",e,r),v;if(i.isEmpty())return g}}catch(l){o.e(l)}finally{o.f()}return i.getIndex()===n.index?g:v},M=function(e,n){if(null!==n){var i=k(e);w.update(i,C(i,n))}},S=[],P=[],W=function(e){return P.includes(e)?null:P.push(e)},A=function(){S.length=0,o.update(f.reduce((function(e,n){return n.reduce((function(e,n){return e+n.getValue()}),e)}),0));for(var e=Array(5).fill(0),n=0;n<f.length;n++)for(var i=f[n],t=0;t<i.length;++t){var r=i[t];if(r.isEmpty())e[t]+=1;else{var s=e[t];s>0&&(W(t),r.moveTileUp(f[n-s][t]),S.push(r))}}if(!S.length){for(var u=0;u<7;u++){var c,d=Object(a.a)(P);try{var h=function(){var e=c.value,n=f[u][e];if(n.isEmpty())return"continue";[{direction:"right",ce:e>0?f[u][e-1]:null},{direction:"left",ce:e<4?f[u][e+1]:null},{direction:"up",ce:f[u+1][e]}].forEach((function(e){var i=e.direction,t=e.ce;null===t||t.isEmpty()||t.getIndex()!==n.getIndex()||("up"===i?(n.mergeTile(t,i),S.push(n)):(t.mergeTile(n,i),S.push(t)))}))};for(d.s();!(c=d.n()).done;)h()}catch(p){d.e(p)}finally{d.f()}}S.length||(P.splice(0,P.length),f.reduce((function(e,n){return n.reduce((function(e,n){var i=n.getIndex();return null===i||i<e?e:i}),e)}),0)>=y&&(y+=2,l.nextTarget()),l.newTile(f.reduce((function(e,n){return n.reduce((function(e,n){var i=n.getIndex();return null===i||i>e?e:i}),e)}),999)))}};return{resize:function(){x(),w.normalize(),f.forEach((function(e){return e.forEach((function(e){return e.resize()}))}))},select:M,move:M,final:function(e,n,i){var t=k(e);w.update(null),null!==t&&n&&C(t,n)===g&&i(t)},addTile:function(e,n){b[n].setTile(e),W(n),A()},animate:function(){z=!1;var e,n=Object(a.a)(S);try{for(n.s();!(e=n.n()).done;){!1===e.value.animate()&&(z=!0)}}catch(i){n.e(i)}finally{n.f()}!z&&S.length>0&&A()}}},d=function e(n){var i=n.index,t=n.allTiles,o=n.str,a=n.color,l=n.unit,s=2<<i,u=new r.b,c=new r.c,f=new r.f({fontFamily:"Arial",fontSize:32,fontWeight:"bold",fill:"#ffffff",align:"center",stroke:"#ffffff",strokeThickness:1,lineJoin:"round"}),d=new r.e(o,f),h=function(e){var n=!0===e?7*l.size:10*l.size;c.clear(),c.lineStyle(0,a,1),c.beginFill(a,1),c.drawRoundedRect(1,1,n-2,n-2,.5*l.size),c.endFill(),d.style.fontSize=!0===e?2.6*l.size:3.6*l.size,d.position.x=.5*n-d.width/2,d.position.y=.27*n};return u.addChild(c),u.addChild(d),h(),{index:i,value:s,container:u,normalize:h,dupTile:function(){return e({index:i,allTiles:t,str:o,color:a,unit:l})},nextTile:function(){return t[i+1].dupTile()},remove:function(){return u.parent?u.parent.removeChild(u):null}}},h=function(e){for(var n=e.offset,i=e.stage,t=e.unit,o=[],l=["2","4","8","16","32","64","128","256","512","1K","2K","4K","8K","16K","32K","64K","128K","256K","512K","1M","2M","4M","8M","16M","32M","64M","128M","256M","512M","1T","2T","4T","8T","16T","32T","64T","128T","256T","512T","1P","2P","4P","8P","16P","32P","64P","128P","256P","512P"],s=r.g.from("assets/raster.png"),u=new r.d(s),c=new r.d(s),f=0,h=function(e){return(Math.floor(80*Math.random())+(1&e?32:112)<<16)+(Math.floor(80*Math.random())+(2&e?32:112)<<8)+(Math.floor(80*Math.random())+(4&e?32:112)<<0)},p=0;p<l.length;++p){var g=h(p),v=l[p];o.push(d({index:p,allTiles:o,str:v,color:g,unit:t}))}var w=null,z=null,y=function(){w&&(w.container.position.x=n.x+25*t.size,w.container.position.y=n.y+85*t.size,w.normalize()),z.container.position.x=n.x+36.5*t.size,z.container.position.y=n.y+86.5*t.size,z.normalize(!0)};return i.addChild(u),i.addChild(c),{tileByIndex:function(e){var n=o[e].dupTile();return i.addChild(n.container),n},renderTiles:function(){var e,n=0,t=Object(a.a)(o);try{for(t.s();!(e=t.n()).done;){var r=e.value;i.addChild(r.container),r.container.position.x=100*Math.floor(n/8),r.container.position.y=100*Math.floor(n%8),n++}}catch(l){t.e(l)}finally{t.f()}},newTile:function(e){w=z,z=function(e){var n;(e=w&&w.index<e?w.index:e)<f?n=f-e:(n=0,e=f);var i=Math.floor(Math.random()*(6+n))+e;return o[i].dupTile()}(e),i.addChild(z.container),y()},getCurrentTile:function(){return w},stealCurrentTile:function(){var e=w;return w=null,e},resize:function(){u.position.x=n.x+24*t.size,u.position.y=n.y+84*t.size,u.width=12*t.size,u.height=12*t.size,c.position.x=n.x+36*t.size,c.position.y=n.y+86*t.size,c.width=8*t.size,c.height=8*t.size,y()},nextTarget:function(){return f++}}},p=function(e){var n=e.offset,i=e.stage,t=e.unit,o=new r.f({fontFamily:"Arial",fontSize:32,fontStyle:"italic",fontWeight:"bold",fill:"#eeeeee",align:"center",stroke:"#ffffff",strokeThickness:2,lineJoin:"round"}),a=new r.e((0).toLocaleString(),o),l=function(){a.x=n.x+30*t.size-a.width/2,a.y=n.y+2*t.size,a.style.fontSize=4*t.size};return i.addChild(a),{resize:l,update:function(e){var n=e.toLocaleString();a.text=n,l()}}},g=function(e){var n=e.container,i={size:10},t={x:0,y:0},o=new r.a({width:window.innerWidth,height:window.innerHeight});n.appendChild(o.view),o.renderer.view.style.position="absolute",o.renderer.view.style.display="block",o.renderer.view.style.backgroundColor="#823456",o.renderer.autoResize=!0;var a=new r.b;a.interactive=!0;var l=function(e){var n=u.stealCurrentTile();n&&(d.addTile(n,e),d.animate())};a.on("pointerdown",(function(e){var n=e.data.getLocalPosition(a);d.select(n,u.getCurrentTile())})).on("pointermove",(function(e){var n=e.data.getLocalPosition(a);d.move(n,u.getCurrentTile())})).on("pointerup",(function(e){var n=e.data.getLocalPosition(a);d.final(n,u.getCurrentTile(),l)}));var s=function(){var e=window.innerWidth,n=window.innerHeight;e<.6*n?(i.size=e/60,t.x=0,t.y=(n-100*i.size)/2):(i.size=n/100,t.x=(e-60*i.size)/2,t.y=0),v.style.fontSize=2.5*i.size,v.x=t.x+16*i.size,v.y=t.y+84*i.size},u=h({offset:t,stage:a,unit:i}),c=p({offset:t,stage:a,unit:i}),d=f({unit:i,offset:t,stage:a,score:c,tiles:u}),g=new r.f({fontFamily:"Arial",dropShadow:!0,dropShadowAlpha:.8,dropShadowAngle:2.1,dropShadowBlur:2,dropShadowColor:"#4a1b7b",dropShadowDistance:10,fill:["#ffffff"],stroke:"#8a3bbb",fontSize:16,fontWeight:"lighter",lineJoin:"round",strokeThickness:11}),v=new r.e("Family Block",g);v.skew.set(-.45,.2),v.anchor.set(.5,-.5),v.x=100,v.y=40,a.addChild(v),u.newTile(0),u.newTile(0);return s(),d.resize(),u.resize(),c.resize(),{resize:function(){s(),c.resize(),d.resize(),u.resize(),o.renderer.resize(window.innerWidth,window.innerHeight)},animate:function e(){requestAnimationFrame(e),d.animate(),o.renderer.render(a)}}}({container:document.body});!function(e){if("serviceWorker"in navigator){if(new URL("https://joente.github.io/familyblock",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var n="".concat("https://joente.github.io/familyblock","/service-worker.js");t?(!function(e,n){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(i){var t=i.headers.get("content-type");404===i.status||null!=t&&-1===t.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):o(e,n)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(n,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):o(n,e)}))}}(),window.addEventListener("resize",g.resize),g.animate()}},[[10,1,2]]]);
//# sourceMappingURL=main.000484fa.chunk.js.map